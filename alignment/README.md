# Convert MUMmer4.0 `.snps` to a Pseudo-VCF File

This guide walks through converting a `.snps` file (generated by MUMmer4.0) into a pseudo-VCF using the [`all2vcf`](https://github.com/MatteoSchiavinato/all2vcf) tool. The example compares *E. coli* (reference) against *Salmonella enterica* (target).

---

## 1. Acquire FASTA Files

You’ll need the NCBI [`datasets`](https://www.ncbi.nlm.nih.gov/datasets/docs/v2/command-line-tools/download-and-install/) CLI installed and accessible in your `$PATH`.

Download reference and target genomes:

```bash
# Download E. coli reference genome
datasets download genome taxon "Escherichia coli" \
  --reference \
  --filename ecoli.zip \
  --include genome

# Download Salmonella enterica target genome
datasets download genome taxon "Salmonella enterica" \
  --reference \
  --filename salmonella.zip \
  --include genome
```

Unzip and extract the `.fna` files for use in alignment.

---

## 2. Set Up [MUMmer4.0](https://mummer4.github.io/)

Ensure you have the MUMmer4.0 suite compiled and available in your environment.

- Download source: [MUMmer4 GitHub](https://github.com/mummer4/mummer)
- After building, add the binaries to your `$PATH`:

```bash
export PATH=/path/to/mummer-bin:$PATH
```

Tools used:
- `nucmer`
- `delta-filter`
- `show-snps`

---

## 3. Install [`all2vcf`](https://github.com/MatteoSchiavinato/all2vcf)

Clone the repository:

```bash
git clone https://github.com/MatteoSchiavinato/all2vcf.git
```

Create and activate a Python virtual environment:

```bash
# Navigate into project
cd all2vcf

# Create virtual environment
python3 -m venv all_to_vcf

# Activate environment
source all_to_vcf/bin/activate
```

Install required packages from `requirements.txt`:

```text
biopython==1.85
pandas==2.3.3
```

Install them with:

```bash
pip install -r requirements.txt
```

Add the project directory to your `$PATH`:

```bash
export PATH=/path/to/all2vcf:$PATH
```

Test the install:

```bash
all2vcf --help
```

---

## 4. Compare Genomes and Generate a Pseudo-VCF

Assuming you have `ecoli.fna` and `salmonella.fna` extracted from earlier:

```bash
# Step 1: Align reference (E. coli) with target (Salmonella)
nucmer -p ecoli_vs_salmonella ecoli.fna salmonella.fna

# Step 2: Filter for 1-to-1 alignments
delta-filter -1 ecoli_vs_salmonella.delta > filtered_ecoli_vs_salmonella.delta

# Step 3: Identify SNPs and INDELs
show-snps -H -T filtered_ecoli_vs_salmonella.delta > var_ecoli_vs_salmonella.snps

# Step 4: Convert .snps to pseudo-VCF format
all2vcf mummer \
  --snps var_ecoli_vs_salmonella.snps \
  --reference ecoli.fna \
  > output.vcf
```

---

## Output

You’ll now have a `output.vcf` file representing differences between *E. coli* and *Salmonella enterica* in VCF-like format, derived from MUMmer's `.snps` output.

---

## Notes

- This is a pseudo-VCF and may lack some formal VCF metadata headers.
- Ensure the reference genome used in `all2vcf` is the same as the one passed to `nucmer`.
